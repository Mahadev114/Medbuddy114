!function(){"use strict";define(["_routes","utility","walletInfoAndConditionsController","newWalletBenController","walletBenefitsController"],function(e,t){e.register.controller("headerController",["$scope","$rootScope","$document","cityList","$location","authService","$window","$state","navConstantsSvc","$http","$uibModal","notify","apiProvider","$sce","localStorageService","$compile","$timeout","corpLabsService",function(e,a,i,o,s,n,r,l,c,d,p,u,g,m,h,y,w,f){function C(){_.isEmpty(D)||_.isEmpty(n.walletConfigs)&&!T||(_.each(n.walletConfigs,function(e){D[e.walletName]&&(D[e.walletName+"EligibleContracts"]=e.eligibleContracts)}),window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!1,hj:!0,dbLog:!0,name:"Wallet Info",payload:window._Site_Props.__getEventParameters({custom:D})}),n.walletInfo=D)}function k(){var t=n.getUserObj();t&&d.post(g.infinitiNode+"tooltiptext",{EntityId:t.userDetails.pmEntityID},{headers:{"Content-Type":"application/json"}}).then(function(t){t.data.isAvailable&&t.data.ToolTipText&&(e.isHelperText=!0,e.helperText=JSON.parse(t.data.ToolTipText))})}function S(){n.makeAjaxCalls(g.infinitiNode+"CorporateData/EntityList",{entityType:6},"POST","","",!1).then(function(t){if(t.data&&t.data.isSuccess){var a=t.data.result;if(e.policyList=a,e.userLinkInsuranceAccount(),window.location.href.includes("medibuddy"))try{var i={appVersion:"",domain:"medibuddyInWeb",event:"HamburgerMenu_LYI_Click"},o=Object.assign({},i,{meta:JSON.stringify(i)});d.post(g.eventlogsUrl,o)}catch(s){console.log(s)}}})["catch"](function(e){})}function b(){n.makeAjaxCalls(g.apiUrl+"GetCorporateFeatureConfiguration",{pMEntityID:e.checkUser.userDetails.pmEntityID},"POST").then(function(i){if(e.checkUser=n.isUserSignedin(),i.data.isSuccess&&i.data.configuration){e.checkUser.corpConfig=i.data.configuration,e.checkUser.corpConfig.enableCorporateServiceNames=t.isJsonObject(e.checkUser.corpConfig.corporateServices)?JSON.parse(e.checkUser.corpConfig.corporateServices).enableCorporateServiceNames:[];var o=e.checkUser.corpConfig.bookTillDate&&parseInt(e.checkUser.corpConfig.bookTillDate.replace("/Date(",""));e.checkUser.corpConfig.bookingBlocked=!1,i.data.serverDate&&(n.serverDate=parseInt(i.data.serverDate.replace("/Date(","")),o>0&&(e.checkUser.corpConfig.bookingBlocked=n.serverDate>=o)),o>0&&(e.checkUser.corpConfig.bookTillDate=new Date(o)),e.checkUser.corpConfig.data=W,e.checkUser&&e.checkUser.userDetails&&c.mchiEntityIds.indexOf(e.checkUser.userDetails.pmEntityID)>-1&&(e.isMchiUser=!0,e.corpConfig=e.checkUser.corpConfig,a.corpConfig=e.checkUser.corpConfig,e.getLogo(e.checkUser))}else e.checkUser.corpConfig=null;n.setUserObj(e.checkUser)})}function v(){var t=n.isUserSignedin();n.makeAjaxCalls(g.apiUrl+"WellnessConfiguration",{pMEntityID:e.checkUser.userDetails.pmEntityID},"POST",t.token).then(function(t){var i;e.checkUser=n.isUserSignedin(),t.data.isSuccess&&t.data.isAddDependentAllowed&&(e.checkUser.isAddDependentAllowed=t.data.isAddDependentAllowed),t.data.isSuccess&&t.data.cwcDisclaimer&&(e.checkUser.cwcDisclaimer=JSON.parse(t.data.cwcDisclaimer)),t.data.isSuccess&&t.data.noSponsoredMessage?e.checkUser.noSponsoredMessage=t.data.noSponsoredMessage:e.checkUser.noSponsoredMessage=!1,e.checkUser.corpMessage=t.data.corporateSponsoredMessage,e.checkUser.isRetailLabsFlowEnabled=t.data.isRetailLabsFlowEnabled,e.checkUser.isMergeFlowEnabled=t.data.isMergeFlowEnabled,e.checkUser.isNewAHCFlowEnabled=!!t.data.isNewAHCFlowEnabled,e.checkUser.retailPrescriptionRequired=t.data.isLabsPrescriptionsRequired,e.checkUser.isReimbursementButton=t.data.isReimbursementButton,e.checkUser.isUpsellEnabled=!e.checkUser.isRetailUser&&e.checkUser.isMergeFlowEnabled,t.data.isSuccess&&t.data.corporateWellnessConfiguration&&e.checkUser?(e.checkUser.corpWellnessConfig=t.data.corporateWellnessConfiguration,i=e.checkUser.corpWellnessConfig.find(function(e){return e&&e.speciality&&e.speciality[0].enableServices})):e.checkUser?t.data.corporateWellnessConfiguration&&(i=e.checkUser.corpWellnessConfig.find(function(e){return e&&e.speciality&&e.speciality[0].enableServices})):(e.checkUser.corpWellnessConfig=null,e.checkUser.isRetailLabsFlowEnabled=!1,e.checkUser.isMergeFlowEnabled=!1,e.checkUser.noSponsoredMessage=!1),n.setUserObj(e.checkUser),_.isEmpty(e.checkUser)||(!e.checkUser.isRetailLabsFlowEnabled&&"app.labs"==l.current.name||!e.checkUser.isMergeFlowEnabled&&"app.consumerLabs"==l.current.name)&&s.url("/"),a.$emit("homePageRefreshList",i&&i.speciality?_.first(i.speciality):null)})}function I(){e.checkUser&&e.checkUser.token&&!e.checkUser.encryptedToken?n.makeAjaxCalls(g.apiUrl+"GetUserLongToken",{shortToken:e.checkUser.token},"POST").then(function(t){t.data.isSuccess&&(e.checkUser=n.isUserSignedin(),e.checkUser.encryptedToken=t.data.encryptedToken,n.setUserObj(e.checkUser),e.authToken=e.checkUser.encryptedToken)}):e.checkUser&&e.checkUser.token&&e.checkUser.encryptedToken&&!e.checkUser.uuid}var U=w(function(){var t=angular.element(document.getElementById("headerView"));t.html(n.returnContents("header.html")),y(t.contents())(e)},0);e.healthCheckId=c.healthCheckId;var D={},T=!1;e.isWebView=a.isWebView,e.newWalletUi=!1,e.walletBenefitsUi=!1,e.showMessage=!1,e.isHelperText=!1,e.editAgeGender=!1;try{FB.init({appId:"198628023814821",status:!0,cookie:!0,xfbml:!0,version:"v3.0"})}catch(P){console.log("Facebook access is dennied"),n.FbNotEnabled=!0}var L=window.location.search,M=new URLSearchParams(L),B=M.get("utm_source"),E=M.get("utm_medium"),N=M.get("utm_campaign");e.fireOnLoadEvent=function(){r.sessionStorage.setItem("utm_source",B?B:"medibuddyInWeb"),E&&r.sessionStorage.setItem("utm_medium",E),N&&r.sessionStorage.setItem("utm_campaign",N),a.utm_source_og=r.sessionStorage.getItem("utm_source"),a.utm_campaign_og=r.sessionStorage.getItem("utm_campaign"),a.utm_medium_og=r.sessionStorage.getItem("utm_medium"),r.sessionStorage.getItem("appLoaded")||(r.sessionStorage.setItem("appLoaded",!0),window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!1,name:"App Loaded",payload:{},branchLog:{name:"Landing",custom_data:{medibuddyUserId:"",pmEntityId:"",source:r.sessionStorage.getItem("utm_source"),maid:"",platform:"MBWeb"}}}),"app.home"==l.current.name&&window._MB_Analytics.__push({isCleverTap:!0,dbLog:"labs",name:"MB Home Page"}))},e.flashbooking=!1,"app.flashBooking"==l.current.name&&(e.flashbooking=!0),a.$on("FBToHome",function(){e.flashbooking=!1}),e.fireOnLoadEvent();var A;requirejs(["tour"],function(t){e.driver=new t({opacity:.5,allowClose:!0,padding:0,keyboardControl:!1,onReset:function(){angular.element(document.body).removeClass("bodyScrollFix"),i(),w.cancel(A)}});var i=a.$on("$stateChangeStart",function(){e.driver.reset()})});var F=e.isMobileView?200:300;e.isSticky=!1,e.handleScrollEvent=function(){var a=t.getScrollPosition(),i=document.querySelector("#products");a>F&&!document.querySelector(".modal-open")?((document.querySelector("header").classList.contains("home")||e.isMobileView)&&(document.querySelector("header").classList.add("sticky-header"),i&&i.classList.contains("sticky-header")&&document.querySelector("#corpLoginBtnNew")&&document.querySelector("ul.nav").classList.add("m-r-0")),i&&!e.isMobileView&&(i.classList.remove("widget"),i.classList.add("sticky-header"),document.querySelector("#products").classList.contains("sticky-header")&&document.querySelector("#corpLoginBtnNew")&&document.querySelector("ul.nav").classList.add("m-r-0")),e.isSticky=!0,e.$apply()):(document.querySelector("header").classList.remove("sticky-header"),document.querySelector("ul.nav").classList.remove("m-r-0"),i&&!e.isMobileView&&(i.classList.remove("sticky-header"),document.querySelector("ul.nav").classList.remove("m-r-0"),i.classList.add("widget")),e.isSticky=!1,e.$apply())},e.walletUi=function(e){p.open({animation:!0,template:'<div class="modal-body br-20"><ng-include src="\'templates/walletBenefits.html\'"></ng-include></div>',controller:"walletBenefitsController",controllerAs:"walletBenefitsControllerCtrl",size:a.isMobileView?"full-height-mobile":"lg"})},e.newWalletBenefitsUi=function(e){p.open({animation:!0,template:'<div class="modal-body br-20"><ng-include src="\'templates/newWalletBen.html\'"></ng-include></div>',controller:"newWalletBenController",controllerAs:"newWalletBenControllerCtrl",size:a.isMobileView?"full-height-mobile":"lg"})},k();var O=_.throttle(e.handleScrollEvent,c.scrollThrottleThreshold);r.addEventListener("scroll",O),e.medsCartInfo=n.medsCartInfo,e.profileToggled=function(t){t&&!angular.element(document.querySelector("header")).hasClass("sticky-header")?(angular.element(document.body).addClass("bodyScrollFix"),A=w(function(){e.driver.highlight({element:document.querySelector("#profile-menu")})})):e.driver.hasHighlightedElement()&&e.driver.reset()},e.hideHeaderFooterForMobile=!!_.isNull(h.get("hideHeaderFooterForMobile"))||h.get("hideHeaderFooterForMobile"),r.scrollTo(0,0),e.walletBalance=0,n.insuranceSelected=!1;var W=c.topCities;e.dummyCities=W;var x=a.$on("selectedCity",function(t,a){e.insuranceSelected=!1,a&&(a.categoryItemTypeId===c.dentalFilterName?(n.topCities=_.intersection(e.dummyCities,o[c.dentalId]),e.selected=a.searchk,e.toggleFilters("Dental"),e.checkForCity(a)):a.categoryItemTypeId===c.medicineFilterName?(n.topCities=_.intersection(e.dummyCities,o[c.medicineId]),e.toggleFilters("app.pharmacy"==l.$current.name?"Pharmacy":"Medicine"),e.medicineKeyword=a.medicine):a.categoryItemTypeId===c.consultationFilterName?(n.topCities=_.intersection(e.dummyCities,o[c.consultationId]),e.selected=a.searchk,e.toggleFilters("Consultation"),e.checkForCity(a)):a.categoryItemTypeId===c.investigationFilterName?(n.topCities=_.intersection(e.dummyCities,o[c.investigationId]),e.investigationKeyWords=a.searchk,e.isCovid=_.contains(c.covidPackageList,a.searchk),e.toggleFilters("Labtest"),"app.labs"!==l.current.name&&e.checkForCity(a)):a.categoryItemTypeId===c.olServiceFilterName?(e.olKeyWords=decodeURIComponent(a.searchk),e.toggleFilters("olService")):a.categoryItemTypeId===c.gsoFilterName?e.toggleFilters("gso"):a.categoryItemTypeId===c.genomFilterName?(e.toggleFilters("Genome"),e.checkForCity(a)):a.categoryItemTypeId===c.homeHealthCareFilterName?(n.topCities=_.intersection(e.dummyCities,o[c.homehealthcareId]),e.keyWords=a.searchc,e.toggleFilters("Home Health Care"),e.checkForCity(a)):a.categoryItemTypeId===c.healthCheckFilterName&&(n.topCities=_.intersection(e.dummyCities,o[c.healthCheckId]),e.selected=a.searchc,e.toggleFilters("Health checks"),e.checkForCity(a))),e.selectedCity=n.getCity()});e.checkForCity=function(t){t.city||n.getCity()||e.selectCity()},e.redirect=function(e,t){l.includes("app.ahc")||(l.go(e,{},{reload:e}),t&&window._MB_Analytics.__push({isCleverTap:!0,name:t}))},e.insuranceClick=function(){e.checkUser=n.getUserObj(),n.insuranceSelected=!0,e.checkUser?l.go("app.insurancePage",{},{reload:"app.insurancePage"}):e.userSignin()},e.getUserProfile=function(){if(e.user&&e.user.token&&e.user.userDetails){var a=g.apiUrl+"UserProfile.json";n.makeAjaxCalls(a,"","GET",e.user.token).then(function(a){if(a.data.isSuccess){e.user=n.isUserSignedin(),window._Site_Props.__setUserObj(e.user),a.data.profile.employeeDetail&&(e.relation=a.data.profile.employeeDetail.beneficiaries,e.formatMAWalletBalance(),e.user.corpDetails.employeeDetail=a.data.profile?a.data.profile.employeeDetail:{},n.setUserObj(e.user)),n.profileInfo=a.data.profile,n.profileInfo&&n.profileInfo.userAddresses&&(n.userAddresses=n.profileInfo.userAddresses.filter(function(e){return e.latitude&&e.longitude})),e.user.isRetailUser?h.set("retailToken",e.user.encryptedToken):h.set("corpToken",e.user.encryptedToken);var i=h.get("toShowMandPopUp"),o=h.get("utm_appname");if(["retailutility"].includes(o))try{if(window.location.href.indexOf("https://www.medibuddy.in/")>-1){var s={screen:o||M.get("utm_source"),appVersion:"",domain:"medibuddyInWeb",event:"MANDATORY_PHONE_NUMBER_SKIP",advertiserId:window.sessionStorage.getItem("branch_fingerprint"),auth_uuid:h.get("auth_uuid")||void 0,mbUserId:e.user.userDetails.userId},l=Object.assign({},s,{meta:JSON.stringify(s)});d.post(g.eventlogsUrl,l)}i=!1}catch(c){}!e.user.isRetailUser&&"true"==i&&e.user.encryptedToken?d.post("https://loginprod.medibuddy.in/user/checkMapping",{deviceId:"",advertiserId:"",platform:"medibuddyInWeb"},{headers:{"Content-Type":"application/json",mbservertoken:e.user.encryptedToken}}).then(function(t){if(t.data&&t.data.result&&t.data.result.showPopUp){if(window.location.href.indexOf("https://www.medibuddy.in/")>-1){var a={screen:"Mandatory_Phone_Number_Popup",appVersion:"",domain:"medibuddyInWeb",event:"LF_MANDATORY_MOBILE_POPUP_SHOWN",advertiserId:window.sessionStorage.getItem("branch_fingerprint"),auth_uuid:h.get("auth_uuid")||void 0,mbUserId:e.user.userDetails.userId},i=Object.assign({},a,{meta:JSON.stringify(a)});d.post(g.eventlogsUrl,i)}return window._MB_Analytics.__push({isCleverTap:!0,dbLog:"mbConsumerLabs",name:"Mandatory Popup Loaded",payload:window._Site_Props.__getEventParameters({custom:{pmEntityId:e.user&&e.user.userDetails?e.user.userDetails.pmEntityID:"",userId:e.user&&e.user.userDetails?e.user.userDetails.userId:""}})}),n.openLoginPopup("lg","templates/openMandatoryMobilePopup.html?"+timeStamp,void 0,"templates/openMandatoryMobilePopup.html?")}t.data&&t.data.result&&t.data.result.auth_uuid&&h.set("auth_uuid",t.data.result.auth_uuid)})["catch"](function(e){console.log("Some Error Occured",e)}):null,n.profileInfo.dob&&(n.profileInfo.dob=new Date(parseInt(n.profileInfo.dob.replace("/Date(","")))),n.profileInfo.gender&&("f"===n.profileInfo.gender.toLowerCase()?n.profileInfo.gender="Female":"m"===n.profileInfo.gender.toLowerCase()?n.profileInfo.gender="Male":n.profileInfo.gender="Others"),e.$emit("userDetails")}if(e.trackUser||n.isSSOLogin){window._Site_Props.__setUserObj(e.user),window._MB_Analytics.__trackUser(!0),e.trackUser=!1;var p=window.navigator.userAgent.toLowerCase(),u="web";if(p.indexOf("android")>-1?u="Android":/iphone|ipod|ipad/.test(p)&&(u="iOS"),window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!0,name:"SignIn",payload:window._Site_Props.__getEventParameters({custom:{userName:n.loggedUserName,SSOLogin:n.isSSOLogin},google:window._Site_Props.__googleTransform("SignIn","",_.property("displayName")(e.user.userDetails)+" has Signed In")}),branchLog:{name:"CustomLogin",custom_data:{medibuddyUserId:t.getFlatProperty(e.user,"userDetails.userId")+"",pmEntityId:t.getFlatProperty(e.user,"userDetails.pmEntityID")+"",source:r.sessionStorage.getItem("utm_source"),maid:t.getFlatProperty(e.user,"userDetails.maid")+"",type:e.user.isRetailUser?"Retail":"Corporate",platform:"MBWeb",browser_fingerprint_id:window.sessionStorage.getItem("branch_fingerprint")||"",os:u}}}),e.user&&e.user.userDetails){var s={pmEntityId:e.user.userDetails.pmEntityID||null,mbUserId:e.user.userDetails.userId||null,email:e.user.userDetails.email||void 0,phone:e.user.userDetails.phone||void 0,name:e.user.userDetails.firstName||void 0,corporateName:e.user.corpDetails&&e.user.corpDetails.employeeDetail&&e.user.corpDetails.employeeDetail.companyName||void 0};window._MB_Analytics.__push({excludeCleverTap:"true",loginEventFlow:!0,dbLog:!0,name:"MBWebsiteLoginSuccessful",payload:window._Site_Props.__getEventParameters({custom:{auth_uuid:h.get("auth_uuid")||void 0,loginScreenEvent:"Login Page",doctorId:s.pmEntityId,screen:"Login",element:"",info:s.name,domain:s.corporateName,appVersion:"",consultationId:s.mbUserId}})}),window._MB_Analytics.__push({excludeCleverTap:"true",loginEventFlow:!0,dbLog:!0,name:"MBAppHomeScreenLanding",payload:window._Site_Props.__getEventParameters({custom:{screen:o||M.get("utm_source"),appVersion:"",domain:"medibuddyInWeb",event:"MBAppHomeScreenLanding",advertiserId:window.sessionStorage.getItem("branch_fingerprint"),auth_uuid:h.get("auth_uuid")||void 0,mbUserId:e.user&&e.user.userDetails&&e.user.userDetails.userId||null,pmEntityId:s.pmEntityId}})})}}})["catch"](function(e){})}},e.formatMAWalletBalance=function(){e.MaWalletDetails&&e.MaWalletDetails.balanceDetail&&(_.forEach(e.MaWalletDetails.balanceDetail.polDetails,function(t,a){var i=_.findWhere(e.relation,{maid:t.maid});_.isEmpty(i)||(t.relation=i.relationName,t.benefName=i.name)}),n.walletDetails=_.without(n.walletDetails,_.findWhere(n.walletDetails,{walletName:"MAWallet"})),n.walletDetails.push(e.MaWalletDetails)),a.$broadcast("showWalletInfo")},e.getWalletConditions=function(){var t=g.apiUrl+"/walletconfig";T=!1,n.makeAjaxCalls(t,{},"POST",e.user.token).then(function(e){e.data.isSuccess&&(n.walletConfigs=e.data.walletConfigs||[]),T=!0,C()})},e.showSubsButton=!1,e.getSubsEligibility=function(){var t=n.getSubsEligibility();t.then(function(t){t.data.isSuccess&&(e.showSubsButton=t.data.isButtonDisplay)})},e.getBalance=function(){var t=n.getWalletBalance();D={},t.then(function(t){e.CorpBalance=0,n.CorpBalance=0,n.MABalance=0,e.benefMABalance=[],e.MBBalance=0,n.MBBalance=0,e.medicalBenefitsName="",e.showStar=!1,n.maDisplayType="",n.corpDisplayType="",n.corpAliasName="",n.maAliasName="",n.walletDetails=[],n.isTermsAndConditionsApplicable=t.data.isTermsOfUseApplied,e.isTermsAndConditionsApplicable=n.isTermsAndConditionsApplicable,n.totalWalletBalance=t.data.totalWalletBalance,t.data.isSuccess&&t.data.walletDetails&&t.data.walletDetails.length>0&&(e.walletDetails=t.data.walletDetails,_.forEach(t.data.walletDetails,function(t,a){"mbwallet"===t.walletName.toLowerCase()?(e.MBBalance=t.balance,n.MBBalance=e.MBBalance,t.isMbWallet=!0,e.MBWalletFound=!0,t.aliasName=t.aliasName?t.aliasName:c.mbWalletDefaultName,n.walletDetails.push(t)):"corpwallet"!==t.walletName.toLowerCase()&&"mawallet"!==t.walletName.toLowerCase()||(e.CorpOrMAWalletFound=!0,"corpwallet"===t.walletName.toLowerCase()&&(n.CorpBalance=t.balance,t.isCorpWallet=!0,e.CorpWalletFound=!0,e.medicalBenefitsName=e.medicalBenefitsName?e.medicalBenefitsName:t.aliasName,t.aliasName=t.aliasName?t.aliasName:c.corpWalletDefaultName,n.corpAliasName=t.aliasName,n.corpDisplayType=t.displayType,n.walletDetails.push(t)),"mawallet"===t.walletName.toLowerCase()&&(n.MABalance=t.balance,t.isMaWallet=!0,e.MaWalletFound=!0,e.MaWalletDetails=t,e.medicalBenefitsName=e.medicalBenefitsName?e.medicalBenefitsName:t.aliasName,t.aliasName=t.aliasName?t.aliasName:c.maWalletDefaultName,n.maAliasName=t.aliasName,n.maDisplayType=t.displayType,n.walletDetails.push(t))),t.balance>0&&(D[t.walletName]=t.balance)}),c.newWalletUiEntityId.indexOf(e.loggedinUser.pmEntityID)>-1&&(e.newWalletUi=!0),c.walletBenefitsUiEntityId.indexOf(e.loggedinUser.pmEntityID)>-1&&(e.walletBenefitsUi=!0),C(),e.CorpOrMAWalletFound&&(e.CorpBalance=parseFloat(n.CorpBalance+n.MABalance).toFixed(2),e.displayBalance=e.CorpBalance.toString(),e.medicalBenefitsName=e.medicalBenefitsName?e.medicalBenefitsName:c.maWalletDefaultName,e.CorpBalance>c.amountDisplayLimit&&(n.maDisplayType||n.corpDisplayType)&&(e.displayBalance=e.displayBalance.substring(0,4)+"..")),(e.MBWalletFound&&!e.CorpOrMAWalletFound||e.CorpOrMAWalletFound&&!e.MBWalletFound)&&(e.addClassBalone=!0),e.MaWalletFound&&e.checkUser&&e.checkUser.userDetails&&e.checkUser.corpDetails&&e.checkUser.corpDetails.employeeDetail?(e.relation=e.checkUser.corpDetails.employeeDetail.beneficiaries,e.formatMAWalletBalance()):(e.CorpOrMAWalletFound||e.MBWalletFound)&&(e.relation?e.formatMAWalletBalance():a.$broadcast("showWalletInfo")))})},e.getLogo=function(t){var i;e.corpConfig&&(i=e.corpConfig.corporateLogo),!i&&t&&t.userDetails&&(i="/static/corpLogo/"+t.userDetails.pmEntityID+".png"),i&&d.get(g.staticUrl.slice(0,-1)+i.slice(7,i.length),{responseType:"blob"}).then(function(e){var t=new FileReader;t.readAsDataURL(e.data),t.onload=function(e){a.corpConfig.corporateLogo=e.target.result}})},e.toggleFilters=function(t){var a=n.toggeFilter(t);e.isFocus=!1,e.isMedicine=a.isMedicine,e.isPharmacy=a.isPharmacy,e.isHealthcheckup=a.isHealthcheckup,e.isConsultation=a.isConsultation,e.isInvestigation=a.isInvestigation,e.isOlService=a.isOlService,e.isHomeHealthCare=a.isHomeHealthCare,e.isDental=a.isDental,e.dataSet.categoryItemTypeId=a.categoryItemTypeId,e.cities=a.cities,n.allCities=e.cities},l.params&&l.params.city?(e.selectedCity=l.params.city,(e.selectedCity&&!n.getCity()||e.selectedCity!==n.getCity())&&n.setCity(e.selectedCity)):h.get("city")&&(e.selectedCity=h.get("city")),window._Site_Props.__setLocation(e.selectedCity),e.user={},e.$state=l,e.placeholderText="Search",e.facebookResponse={email:""};e.cities=o,n.allCities=e.cities,e.isopenCityModel=!1,e.isEmailValid=!0,e.isopenlogin=!1,e.isopenCity=!1;if(e.checkUser=n.isUserSignedin(),e.islogin=!1,e.checkUser){if(e.user=e.checkUser,e.islogin=!0,n.refreshOrders=!0,e.getBalance(),e.getWalletConditions(),e.getUserProfile(),c.subscriptionEntityIds.indexOf(e.checkUser.userDetails.pmEntityID)>-1&&e.getSubsEligibility(),e.authToken=e.checkUser.encryptedToken,c.accentureProfileEditEntityIds.indexOf(e.checkUser.userDetails.pmEntityID)>-1){var H=new Date(parseInt(e.checkUser.userDetails.dateOfBirth.replace("/Date(",""))),R=new Date("Jan 01 1900");H.getFullYear()==R.getFullYear()&&(e.editAgeGender=!0)}var $=n.isUserSignedin();$&&$.userDetails&&c.mchiEntityIds.indexOf($.userDetails.pmEntityID)>-1&&(e.isMchiUser=!0,e.corpConfig=$.corpConfig,a.corpConfig=$.corpConfig,a.corpConfig&&e.getLogo($)),e.checkUser.isRetailUser=t.getFlatProperty(e.checkUser,"userDetails.pmEntityID")===c.retailUserEntityId,n.setUserObj(e.checkUser),I(),e.checkUser.isRetailUser||e.checkUser.corpConfig||!e.checkUser.corpDetails||b(),v(),e.userName=e.user.userDetails.displayName.charAt(0).toUpperCase()+e.user.userDetails.displayName.slice(1),e.loggedinUser=e.checkUser.userDetails,e.loggedinUser&&(e.islogin=!0),e.userName=e.user.userDetails.displayName.charAt(0).toUpperCase()+e.user.userDetails.displayName.slice(1),a.$emit("closePopup",{})}else e.loggedinUser=e.checkUser,e.userName="";e.signInCorpAcc=function(){n.showLinkingScreen=!0,n.openLoginPopup("lg","templates/openLoginPopUpnew.html?"+timeStamp)},e.corporateflowswitch=function(){window.sessionStorage.setItem("corp_redirection_cta",!0);var e="";l.includes("app.corporate")?(e="Redirection to Merge Flow",l.go("app.consumercorplabs")):l.includes("app.consumercorplabs")&&(e="Redirection to Corporate Flow",l.go("app.corporate")),e&&f.sendEvents(e)},e.trackOrderAhc=function(){window._MB_Analytics.__push({isCleverTap:!0,hj:!0,name:"AHC Track Order",payload:window._Site_Props.__getEventParameters({custom:{Origin:"AHC Landing Page"}})}),l.go("app.ahcOrderListing")},e.aboutUsRedirect=function(){try{window._MB_Analytics.__push({branchLog:{name:"AboutUsInweb",custom_data:{medibuddyUserId:"",pmEntityId:"",source:window.sessionStorage.getItem("utm_source")||"",maid:"",platform:"MBWeb",browser_fingerprint_id:window.sessionStorage.getItem("branch_fingerprint")||""}}})}catch(e){console.log(e)}l.go("app.aboutus")},e.userSigninOld=function(e){try{if(f.sendEvents("Link Corp Account"),"https://www.medibuddy.in/"===window.location.href){var t={screen:"Login",appVersion:"",domain:"medibuddyInweb",event:"linkCorpAccClick"},a=Object.assign({},t,{meta:JSON.stringify(t)});d.post(g.eventlogsUrl,a)}window._MB_Analytics.__push({excludeCleverTap:"true",loginEventFlow:!0,dbLog:!0,name:"LF_CORPORATE_LOGIN_INITATE",payload:window._Site_Props.__getEventParameters({custom:{auth_uuid:h.get("auth_uuid")||void 0,loginScreenEvent:"CORP_FRM_RETAIL"}})})}catch(i){console.log(i)}n.showRegisterTab=e,n.showLinkingScreen=!1,n.openLoginPopupCorp("lg","templates/corporateLoginPopup.html?"+timeStamp)},e.userSignin=function(e){try{window._MB_Analytics.__push({branchLog:{name:"LoginInweb",custom_data:{medibuddyUserId:"",pmEntityId:"",source:window.sessionStorage.getItem("utm_source")||"",maid:"",platform:"MBWeb",browser_fingerprint_id:window.sessionStorage.getItem("branch_fingerprint")||""}}})}catch(t){console.log(t)}window._MB_Analytics.__push({excludeCleverTap:"true",dbLog:!0,name:"LF_LOGIN_INITATE",payload:window._Site_Props.__getEventParameters({custom:{auth_uuid:h.get("auth_uuid")||void 0,loginScreen:"Retail_Login"}})}),n.showRegisterTab=e,n.showLinkingScreen=!1,n.openLoginPopup("lg","templates/openLoginPopUpnew.html?"+timeStamp)},e.userSignup=function(){n.showLinkingScreen=!1,n.openSingupPopup("","templates/openSignup.html?"+timeStamp)},e.openSubsPopup=function(){n.openSubsPopup()},e.checkoutSubsCart=function(){console.log("puhsed cart item to db/redis"),s.url("/subsCheckout")},e.$on("landingUrl",function(e,t){var a=s.$$path;r.location.replace(a)}),e.policyList=[],e.userLinkInsuranceAccount=function(){e.policyList.length>0?n.openInsurancePopUp("lg","templates/insuranceAccountLink.html?"+timeStamp,{policyList:e.policyList,userInfo:e.checkUser.userDetails}):S()};var G=a.$on("refreshWallet",function(t,a){e.getBalance()}),j=a.$on("userLogin",function(i,o){k(),e.checkUser=n.getUserObj(),a.corpConfig=null,e.checkUser&&(e.user=e.checkUser,V(),e.trackUser=!0,e.getUserProfile(),e.islogin=!0,n.refreshOrders=!0,e.getBalance(),c.subscriptionEntityIds.indexOf(e.checkUser.userDetails.pmEntityID)>-1&&e.getSubsEligibility(),e.getWalletConditions(),e.checkUser.isRetailUser=t.getFlatProperty(e.checkUser,"userDetails.pmEntityID")===c.retailUserEntityId,n.setUserObj(e.checkUser),I(),e.checkUser.isRetailUser||e.checkUser.corpConfig||!e.checkUser.corpDetails||b(),v(),n.insuranceSelected&&e.insuranceClick(),e.userName=e.user.userDetails.displayName.charAt(0).toUpperCase()+e.user.userDetails.displayName.slice(1),e.loggedinUser=e.checkUser.userDetails,e.loggedinUser&&(e.islogin=!0),e.userName=e.user.userDetails.displayName.charAt(0).toUpperCase()+e.user.userDetails.displayName.slice(1),"app.medicine"===l.current.name?e.$emit("userProfile",!0):e.$emit("openAppointmentForm",n.setBookingData))});a.$$listeners.userLogout=[];a.$on("userLogout",function(t,i){e.isHelperText=!1,e.isCorpUser=!1,e.showMessage=!1,a.corpConfig=null,e.newWalletUi=!1,e.isMchiUser=!1,e.walletBenefitsUi=!1,e.editAgeGender=!1,e.user.userDetails&&window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!0,name:"SignOut",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("SignOut","",_.property("displayName")(e.user.userDetails)+" has Signed Out")})}),e.user={},window._Site_Props.__setUserObj(e.user),e.islogin=!1,n.orderHistory=[],D={}});e.dataSet={categoryItemTypeId:e.categoryItemTypeId,keyword:"",condition:"",pinCode:""},e.keyWords=void 0,e.selected=void 0,e.searchk=function(){e.megaSearchData&&0!==e.megaSearchData.length?e.showMegaSearch=!1:e.showMegaSearch?u({message:"Please select the procedure to proceed",position:"center",duration:5e3}):e.showMegaSearch=!0},e.onBlur=function(){e.placeholderText="select",e.isFocus=!1},e.onFocusHc=function(){e.placeholderText="type",e.searchCondition=["Master","Executive","Preventive","Diabetes","Cardiac","Cancer"],e.isFocus=!0},e.onFocus=function(){e.placeholderText="type",e.searchCondition=[],e.isFocus=!0},e.onFocusHHCare=function(){e.placeholderText="Type",e.searchCondition=["Physiotherapist Visit","Attendant Visit","Nursing Visit"],e.isFocus=!0},e.getkeywords=function(){e.placeholderText="type"},e.onSelect=function(t,a,i){e.dataSet.condition=a;var o=e.dataSet.condition+" health check in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Health checks","search",o)})}),l.go("app.packagesnew",{categoryItemTypeId:c.healthCheckFilterName,searchc:e.dataSet.condition,searchdata:e.dataSet.condition+" health checkup packages in "+e.selectedCity,city:e.selectedCity},{reload:"app.packagesnew"}),e.toggleFilters("Health checks")},e.ngModelOptionsSelected=function(e){var t;return arguments.length?void(t=e):t},e.modelOptions={debounce:{"default":200,blur:250},getterSetter:!0},e.isConsultsLoading=!1,e.getconsultation=function(t){return t?t.length>2?(e.isConsultsLoading=!0,d.get(g.apiUrl+"keywordlookup/"+e.dataSet.categoryItemTypeId+"/"+t+"/0/0.json",{headers:{City:e.selectedCity}}).then(function(t){if(e.isConsultsLoading=!1,t.data.keywords&&0!==t.data.keywords.length)return t.data.keywords},function(t){e.isConsultsLoading=!1})):void 0:["Cardiologist","Gynaecologist","Nephrologist","Gastroenterologist","Ophthalmologist","ENT","Paediatrician","General Physician"]},e.isDentalLoading=!1,e.getDental=function(t){return t?t.length>2?(e.isDentalLoading=!0,d.get(g.apiUrl+"keywordlookup/"+e.dataSet.categoryItemTypeId+"/"+t+"/0/0.json",{headers:{City:e.selectedCity}}).then(function(t){if(e.isDentalLoading=!1,t.data.keywords&&0!==t.data.keywords.length)return t.data.keywords},function(t){e.isDentalLoading=!1})):void 0:["Dentist","Dental Surgeon","Periodontist","Pedodontist","Prosthodontist","Orthodontist","Oral & Maxillofacial Surgeon"]},e.isLabTestsLoading=!1,e.getLabTestKeywords=function(t){return t?t.length>2?(e.isLabTestsLoading=!0,d.get(g.apiUrl+"keywordlookup/"+e.dataSet.categoryItemTypeId+"/"+t+"/0/0.json",{headers:{City:e.selectedCity}}).then(function(t){if(e.isLabTestsLoading=!1,t.data.keywords&&t.data.keywords.length>0)return t.data.keywords},function(t){e.isLabTestsLoading=!1})):void 0:e.isCovid?_.isEmpty(e.user)||e.user&&e.user.isRetailUser?["COVID-19 RT-PCR - Swab Test","COVID-19 Antibody - GT - Blood Test"]:["COVID-19 RT-PCR - Swab Test","COVID-19 Antibody - GT - Blood Test"]:["T3","Vitamin B12","HBA1C","Liver Function Test","CBC","Lipid Profile"]},e.onSelectInvestigation=function(t,a,i){e.dataSet.keyword=a;var o=e.dataSet.condition+" in city "+e.cityName;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Labtest","search",o)})}),l.go("app.labtest",{searchk:e.dataSet.keyword,city:e.selectedCity},{reload:"app.labtest"})},e.onSelectConsultation=function(t,a,i){e.dataSet.condition=a;var o=e.dataSet.condition+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("consultation","search",o)})}),l.go("app.consultation",{categoryItemTypeId:c.consultationFilterName,searchk:e.dataSet.condition,city:e.selectedCity,location:e.selectedLocality},{reload:"app.consultation"}),e.toggleFilters("Consultation")},e.onSelectDental=function(t,a,i){e.dataSet.condition=a;var o=e.dataSet.condition+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Dental","search",o)})}),l.go("app.dentalPage",{categoryItemTypeId:c.dentalFilterName,searchk:e.dataSet.condition,city:e.selectedCity},{reload:"app.dentalPage"}),e.toggleFilters("Dental")},e.onFocusOlService=function(){e.placeholderText="Type",e.searchCondition=["Cardiologist","Gynaecologist","Nephrologist","Gastroenterologist","Ophthalmologist","ENT","Paediatrician","General Physician"]},e.onSelectOlService=function(t,a,i){e.dataSet.keyword=a;var o=e.dataSet.keyword+" in olService";window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Tele Consultation","search",o)})}),l.go("app.olservice",{searchc:"",searchk:e.dataSet.keyword},{reload:"app.olservice"})},e.showExploreInvestigation=function(t){if(t){e.dataSet.keyword=t;var a=e.dataSet.keyword+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Labtest","search",a)})}),l.go("app.labtest",{searchk:e.dataSet.keyword,city:e.selectedCity},{reload:"app.labtest"}),e.toggleFilters("Labtest")}},e.showExploreConsultation=function(t){if(t){e.dataSet.keyword=t;var a=e.dataSet.keyword+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("consultation","search",a)
})}),l.go("app.consultation",{categoryItemTypeId:c.consultationFilterName,searchk:e.dataSet.keyword,city:e.selectedCity,location:e.selectedLocality},{reload:"app.consultation"}),e.toggleFilters("Consultation")}},e.showExploreDental=function(t){if(t){e.dataSet.keyword=t;var a=e.dataSet.keyword+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Dental","search",a)})}),l.go("app.dentalPage",{categoryItemTypeId:c.dentalFilterName,searchk:e.dataSet.keyword,city:e.selectedCity},{reload:"app.dentalPage"}),e.toggleFilters("Dental")}},e.showExploreMedicine=function(t){if(t&&6==t.length)if(n.setPincode(t),e.isPharmacy)l.go("app.pharmacy",{medicine:e.medicineKeyword,pincode:t},{reload:"app.pharmacy"});else{var a=t+" in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Medicine","search",a)})}),l.go("app.medicine",{city:e.selectedCity,pincode:t},{reload:"app.medicine"})}},e.showExplorePharmacy=function(e){e&&e.length>2&&(window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!1,name:"Pharmacy Cart",payload:window._Site_Props.__getEventParameters({custom:{medicine:e,pincode:n.getPincode()}})}),l.go("app.pharmacy",{medicine:e,pincode:n.getPincode()},{reload:"app.pharmacy"}))},e.showExplorePage=function(t){if(t){e.dataSet.condition="",e.dataSet.keyword=t;var a=e.dataSet.keyword+" health check in city "+e.selectedCity;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Health checks","search",a)})}),l.go("app.packagesnew",{categoryItemTypeId:c.healthCheckFilterName,searchc:e.dataSet.keyword,searchdata:e.dataSet.keyword+" health checkup packages in "+e.selectedCity,city:e.selectedCity},{reload:"app.packagesnew"}),e.toggleFilters("Health checks")}},e.selectMatch=function(t){e.keyWordValue=t},e.onSelectHHCare=function(t,a,i){e.dataSet.condition=a;var o=e.dataSet.condition+" in city "+e.cityName;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Home Health Care","search",o)})}),l.go("app.homehealthcare",{categoryItemTypeId:c.homeHealthCareFilterName,searchc:e.dataSet.condition,city:e.selectedCity},{reload:"app.homehealthcare"})},e.showExploreHHcare=function(t){if(t){e.dataSet.condition=t;var a=e.dataSet.condition+" in city "+e.cityName;window._MB_Analytics.__push({isCleverTap:!1,isGoogle:!0,name:"event",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("Home Health Care","search",a)})}),l.go("app.homehealthcare",{categoryItemTypeId:c.homeHealthCareFilterName,searchc:e.dataSet.condition,city:e.selectedCity},{reload:"app.homehealthcare"})}},e.setUserCity=function(t){n.setCity(t),n.cityData=t,e.cityName=n.cityData,e.selectedCity=e.cityName,window._Site_Props.__setLocation(e.cityName),window._MB_Analytics.__push({isCleverTap:!0,isGoogle:!0,name:"City Change",payload:window._Site_Props.__getEventParameters({google:window._Site_Props.__googleTransform("City","Change","City Changed to "+e.cityName)})}),a.$broadcast("changeCity",e.cityName)},e.showBenefWalletAllotment=function(){if((e.isTermsAndConditionsApplicable||e.MaWalletFound)&&!l.is("app.walletInfo")){p.open({animation:!0,template:'<div class="modal-body"><button class="btn btn-default btn-close pull-left" type="button" ng-click="cancelDialog()"><i class="mm mm-close"></i></button><ng-include src="\'templates/walletInfoAndConditions.html\'"></ng-include></div>',controller:"walletInfoAndConditionsController",controllerAs:"walletInfoCtrl",size:a.isMobileView?"full-height-mobile":"lg"})}},e.selectCity=function(){(l.includes("app.corporate")||l.includes("app.corporateListing"))&&_.isEmpty(n.corporatePackages)||(n.cityError="",n.cityPopup("lg"))},e.$on("allCities",function(t,a){a&&e.setUserCity(a)});document.querySelector("#mb-widget");e.signout=function(){n.makeAjaxCalls(g.apiUrl+"MPLogout",{AceessToken:e.user.token},"POST").then(function(e){}),n.logoutUser(),e.isMchiUser=!1,e.corpConfig=null,e.islogin=!1,e.loggedinUser={},e.user={},e.MBBalance=0,e.MBWalletFound=!1,n.MBBalance=0,n.MBWalletFound=!1,e.CorpBalance=0,e.CorpWalletFound=!1,e.CorpOrMAWalletFound=!1,e.MaWalletFound=!1,n.CorpWalletFound=!1,n.CorpBalance=0,e.addClassBalone=!1,n.walletConfigs=[],n.walletInfo={},a.OneClickFlowLogin=!1,h.remove("policyNumber"),h.remove("subs_eligible")},e.clearText=function(){e.keywords="",e.keyWords="",e.selected="",e.investigationKeyWords="",e.olKeyWords="",e.medicineKeyword=""},e.showHomePage=function(){e.flashbooking=!1,e.keywords="",e.selected="",e.investigationKeyWords="","app.home"!==l.current.name&&"app.mediCheckoutCart"!==l.current.name&&"app.checkout"!==l.current.name&&"app.ahcCheckout"!==l.current.name&&"app.consumerLabsCheckout"!==l.current.name&&l.go("app.home",{},{reload:"app.home"})},e.notifyMessage=c.notifyMessage;var V=function(){e.showMessage=!1,e.notifyMessage=""};V(),e.categoryResult={numberProvider:100,categories:["dentist","prosthodontist","orthodontist","dentist","endodontist","implantologist"]},e.categoryProceduresResult={numberProvider:100,procedures:["Bonding","Braces","Bridges and Implants","Crowns and Caps","Dentures","Extractions","Filling and Repairs","Gum Surgery","Oral Cancer Examinations","Root Canals","Sealants","Teeth Whitening","Veneers"]},e.cartItemCount=0,e.$on("cartItemsCount",function(t,a){e.cartItemCount=a}),a.$on("$destroy",function(){j(),x(),G(),w.cancel(U),deregisterCoporateConfig(),r.removeEventListener("scroll",O),document.querySelector("header").classList.remove("sticky-header"),e.isSticky=!1,e.$apply()}),e.getHospitalization=function(){l.go("app.hospitalization",{reload:"app.hospitalization"})}}])})}();